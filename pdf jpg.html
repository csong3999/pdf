<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>高质量PDF转图片工具</title>
  
  <!-- 引入外部资源 -->
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <!-- PDF处理库 -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.min.js"></script>
  <!-- 文件压缩库 -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
  <!-- 下载库 -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
  
  <!-- Tailwind 配置 -->
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#3B82F6',
            secondary: '#10B981',
            accent: '#F59E0B',
            neutral: '#1F2937'
          },
          fontFamily: {
            inter: ['Inter', 'system-ui', 'sans-serif'],
          },
        },
      }
    }
  </script>
  
  <!-- 自定义样式 -->
  <style type="text/tailwindcss">
    @layer utilities {
      .content-auto {
        content-visibility: auto;
      }
      .transition-transform-opacity {
        transition-property: transform, opacity;
      }
      .image-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
        gap: 1.5rem;
      }
      .drop-highlight {
        @apply border-primary bg-primary/5;
      }
      .pdf-preview {
        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        transition: all 0.3s ease;
      }
      .pdf-preview:hover {
        box-shadow: 0 8px 24px rgba(0,0,0,0.15);
      }
    }
  </style>
</head>
<body class="font-inter bg-gray-50 text-neutral min-h-screen flex flex-col">
  <!-- 导航栏 -->
  <header class="bg-white shadow-md sticky top-0 z-50 transition-all duration-300">
    <div class="container mx-auto px-4 py-4 flex justify-between items-center">
      <div class="flex items-center space-x-2">
        <i class="fa fa-file-image-o text-accent text-2xl"></i>
        <h1 class="text-xl md:text-2xl font-bold bg-gradient-to-r from-primary to-accent bg-clip-text text-transparent">高质量PDF转图片</h1>
      </div>
      <div class="hidden md:flex items-center space-x-6">
        <a href="#" class="text-gray-600 hover:text-primary transition-colors duration-300 flex items-center">
          <i class="fa fa-question-circle mr-1"></i>帮助
        </a>
        <a href="#" class="text-gray-600 hover:text-primary transition-colors duration-300 flex items-center">
          <i class="fa fa-info-circle mr-1"></i>关于
        </a>
      </div>
      <button class="md:hidden text-gray-600 focus:outline-none" id="menuToggle">
        <i class="fa fa-bars text-xl"></i>
      </button>
    </div>
    <!-- 移动端菜单 -->
    <div id="mobileMenu" class="hidden md:hidden bg-white px-4 py-2 shadow-lg animate-fadeIn">
      <a href="#" class="block py-2 text-gray-600 hover:text-primary transition-colors duration-300">
        <i class="fa fa-question-circle mr-1"></i>帮助
      </a>
      <a href="#" class="block py-2 text-gray-600 hover:text-primary transition-colors duration-300">
        <i class="fa fa-info-circle mr-1"></i>关于
      </a>
    </div>
  </header>

  <!-- 主要内容区 -->
  <main class="flex-grow container mx-auto px-4 py-8">
    <!-- 介绍卡片 -->
    <div class="bg-gradient-to-r from-primary/10 to-accent/10 rounded-2xl p-6 mb-8 shadow-sm transform hover:shadow-md transition-all duration-300">
      <h2 class="text-xl font-bold mb-2">保留原图质量的PDF转图片解决方案</h2>
      <p class="text-gray-600">采用高分辨率渲染技术，将PDF每一页转换为高质量JPG图片，最大限度保留原始细节。</p>
    </div>

    <!-- 上传区域 -->
    <div id="dropArea" class="border-2 border-dashed border-gray-300 rounded-2xl p-10 text-center mb-10 hover:border-primary transition-all duration-300 cursor-pointer bg-white shadow-sm">
      <div class="max-w-md mx-auto">
        <i class="fa fa-file-pdf-o text-5xl text-gray-400 mb-4 hover:text-primary transition-colors duration-300"></i>
        <h3 class="text-lg font-semibold mb-2">拖放PDF文件到此处，或点击上传</h3>
        <p class="text-gray-500 mb-6">支持标准PDF格式文件，转换将保留原图质量</p>
        <label class="inline-block bg-primary hover:bg-primary/90 text-white font-medium py-3 px-6 rounded-lg transition-all duration-300 shadow-md hover:shadow-lg transform hover:-translate-y-1">
          <i class="fa fa-file-pdf-o mr-2"></i>选择PDF文件
          <input type="file" id="fileInput" accept=".pdf" class="hidden">
        </label>
      </div>
    </div>

    <!-- PDF预览区域 -->
    <div id="pdfPreviewSection" class="mb-10 hidden">
      <div class="flex flex-wrap justify-between items-center mb-6 gap-4">
        <h3 class="text-xl font-bold">PDF预览 <span class="text-sm font-normal text-gray-500">(共 <span id="totalPages">0</span> 页)</span></h3>
        <div class="flex gap-2">
          <div class="relative">
            <select id="imageQuality" class="bg-gray-100 border border-gray-200 text-gray-700 py-2 pl-4 pr-10 rounded-lg appearance-none focus:outline-none focus:ring-2 focus:ring-primary/50">
              <option value="1.0">无损质量</option>
              <option value="0.95" selected>最高质量</option>
              <option value="0.9">高质量</option>
              <option value="0.8">平衡质量</option>
            </select>
            <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700">
              <i class="fa fa-chevron-down text-xs"></i>
            </div>
          </div>
          <div class="relative">
            <select id="renderDpi" class="bg-gray-100 border border-gray-200 text-gray-700 py-2 pl-4 pr-10 rounded-lg appearance-none focus:outline-none focus:ring-2 focus:ring-primary/50">
              <option value="3.0">超高分辨率 (300dpi)</option>
              <option value="2.0" selected>高分辨率 (200dpi)</option>
              <option value="1.5">标准分辨率 (150dpi)</option>
              <option value="1.0">基础分辨率 (100dpi)</option>
            </select>
            <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700">
              <i class="fa fa-chevron-down text-xs"></i>
            </div>
          </div>
          <button id="convertAll" class="bg-secondary hover:bg-secondary/90 text-white font-medium py-2 px-6 rounded-lg transition-all duration-300 shadow-md hover:shadow-lg flex items-center">
            <i class="fa fa-magic mr-2"></i>转换所有页
          </button>
        </div>
      </div>
      
      <div id="pdfContainer" class="flex flex-col gap-6 mb-6">
        <!-- PDF页面预览将在这里动态生成 -->
      </div>
      
      <!-- 分页控制 -->
      <div id="paginationControls" class="flex justify-center items-center gap-4 hidden">
        <button id="prevPage" class="p-2 rounded-full border border-gray-300 hover:border-primary hover:text-primary transition-colors disabled:opacity-50 disabled:cursor-not-allowed">
          <i class="fa fa-chevron-left"></i>
        </button>
        <span id="pageInfo" class="text-gray-600">第 1 页 / 共 0 页</span>
        <button id="nextPage" class="p-2 rounded-full border border-gray-300 hover:border-primary hover:text-primary transition-colors disabled:opacity-50 disabled:cursor-not-allowed">
          <i class="fa fa-chevron-right"></i>
        </button>
      </div>
    </div>

    <!-- 转换后的图片区域 -->
    <div id="imagesSection" class="mb-10 hidden">
      <div class="flex flex-wrap justify-between items-center mb-6 gap-4">
        <h3 class="text-xl font-bold">转换结果 <span class="text-sm font-normal text-gray-500">(共 <span id="convertedCount">0</span> 张图片)</span></h3>
        <button id="downloadAll" class="bg-accent hover:bg-accent/90 text-white font-medium py-2 px-6 rounded-lg transition-all duration-300 shadow-md hover:shadow-lg flex items-center">
          <i class="fa fa-download mr-2"></i>下载全部图片
        </button>
      </div>
      
      <div id="imagesContainer" class="image-grid">
        <!-- 转换后的图片将在这里动态生成 -->
      </div>
    </div>

    <!-- 加载状态 -->
    <div id="loadingSection" class="flex flex-col items-center justify-center py-10 hidden">
      <div class="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary mb-4"></div>
      <p class="text-gray-600" id="loadingText">正在处理PDF文件，请稍候...</p>
      <p class="text-gray-500 text-sm mt-2" id="qualityNote">高质量转换可能需要更长时间...</p>
    </div>

    <!-- 成功提示 -->
    <div id="successSection" class="bg-green-50 border border-green-200 rounded-lg p-6 flex items-center justify-center hidden animate-fadeIn">
      <i class="fa fa-check-circle text-green-500 text-2xl mr-3"></i>
      <div>
        <h4 class="font-medium text-green-800">高质量转换成功！</h4>
        <p class="text-green-700 text-sm">图片保留了原始PDF的细节质量</p>
      </div>
    </div>

    <!-- 使用说明 -->
    <div class="bg-white rounded-xl p-6 shadow-sm mb-10 transform hover:shadow-md transition-all duration-300">
      <h3 class="text-lg font-bold mb-4">高质量转换说明</h3>
      <ol class="list-decimal list-inside space-y-2 text-gray-600">
        <li>选择"无损质量"和"超高分辨率"可获得最佳画质（文件体积较大）</li>
        <li>高分辨率转换可能需要更长时间，请耐心等待</li>
        <li>对于包含精细文字或图表的PDF，建议使用200dpi以上分辨率</li>
        <li>转换后的图片尺寸与原始PDF页面尺寸成比例，保持原始比例</li>
      </ol>
    </div>
  </main>

  <!-- 页脚 -->
  <footer class="bg-neutral text-white py-8">
    <div class="container mx-auto px-4">
      <div class="flex flex-col md:flex-row justify-between items-center">
        <div class="mb-4 md:mb-0">
          <div class="flex items-center space-x-2">
            <i class="fa fa-file-image-o text-accent"></i>
            <span class="font-bold">高质量PDF转图片工具</span>
          </div>
          <p class="text-gray-400 text-sm mt-1">专注于保留原始画质的转换解决方案</p>
        </div>
        <div class="flex space-x-6">
          <a href="#" class="text-gray-400 hover:text-white transition-colors duration-300">
            <i class="fa fa-github text-xl"></i>
          </a>
          <a href="#" class="text-gray-400 hover:text-white transition-colors duration-300">
            <i class="fa fa-twitter text-xl"></i>
          </a>
          <a href="#" class="text-gray-400 hover:text-white transition-colors duration-300">
            <i class="fa fa-envelope text-xl"></i>
          </a>
        </div>
      </div>
      <div class="border-t border-gray-700 mt-6 pt-6 text-center text-gray-400 text-sm">
        &copy; 2023 高质量PDF转图片工具 - 所有操作均在本地完成
      </div>
    </div>
  </footer>

  <!-- JavaScript 代码 -->
  <script>
    // 全局变量
    let pdfDoc = null;
    let totalPages = 0;
    let currentPage = 1;
    let convertedImages = [];
    let isDragging = false;
    
    // PDF.js 配置
    const pdfjsLib = window['pdfjs-dist/build/pdf'];
    pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.worker.min.js';
    
    // DOM 元素
    const dropArea = document.getElementById('dropArea');
    const fileInput = document.getElementById('fileInput');
    const pdfPreviewSection = document.getElementById('pdfPreviewSection');
    const pdfContainer = document.getElementById('pdfContainer');
    const totalPagesEl = document.getElementById('totalPages');
    const pageInfoEl = document.getElementById('pageInfo');
    const prevPageBtn = document.getElementById('prevPage');
    const nextPageBtn = document.getElementById('nextPage');
    const paginationControls = document.getElementById('paginationControls');
    const convertAllBtn = document.getElementById('convertAll');
    const imagesSection = document.getElementById('imagesSection');
    const imagesContainer = document.getElementById('imagesContainer');
    const convertedCountEl = document.getElementById('convertedCount');
    const downloadAllBtn = document.getElementById('downloadAll');
    const loadingSection = document.getElementById('loadingSection');
    const loadingText = document.getElementById('loadingText');
    const successSection = document.getElementById('successSection');
    const imageQualitySelect = document.getElementById('imageQuality');
    const renderDpiSelect = document.getElementById('renderDpi');
    const menuToggle = document.getElementById('menuToggle');
    const mobileMenu = document.getElementById('mobileMenu');

    // 移动端菜单切换
    menuToggle.addEventListener('click', () => {
      mobileMenu.classList.toggle('hidden');
    });

    // 上传区域点击触发文件选择
    dropArea.addEventListener('click', () => {
      if (!isDragging) {
        fileInput.click();
      }
    });

    // 处理文件选择
    fileInput.addEventListener('change', handleFileSelect);

    // 拖放事件处理
    ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
      dropArea.addEventListener(eventName, preventDefaults, false);
    });

    function preventDefaults(e) {
      e.preventDefault();
      e.stopPropagation();
    }

    ['dragenter', 'dragover'].forEach(eventName => {
      dropArea.addEventListener(eventName, highlight, false);
    });

    ['dragleave', 'drop'].forEach(eventName => {
      dropArea.addEventListener(eventName, unhighlight, false);
    });

    function highlight() {
      dropArea.classList.add('drop-highlight');
      isDragging = true;
    }

    function unhighlight() {
      dropArea.classList.remove('drop-highlight');
      isDragging = false;
    }

    // 处理拖放的文件
    dropArea.addEventListener('drop', handleDrop, false);

    function handleDrop(e) {
      const dt = e.dataTransfer;
      const files = dt.files;
      
      if (files.length) {
        const file = files[0];
        if (file.type === 'application/pdf' || file.name.endsWith('.pdf')) {
          handlePdfFile(file);
        } else {
          alert('请上传PDF格式的文件');
        }
      }
    }

    // 处理选择的文件
    function handleFileSelect(e) {
      const files = e.target.files;
      if (files.length) {
        handlePdfFile(files[0]);
      }
    }

    // 处理PDF文件
    function handlePdfFile(file) {
      // 显示加载状态
      showLoading('正在加载PDF文件...');
      
      // 重置之前的状态
      pdfDoc = null;
      convertedImages = [];
      imagesContainer.innerHTML = '';
      imagesSection.classList.add('hidden');
      successSection.classList.add('hidden');
      
      const fileReader = new FileReader();
      
      fileReader.onload = function() {
        const typedArray = new Uint8Array(this.result);
        
        // 加载PDF文档
        pdfjsLib.getDocument(typedArray).promise.then(function(pdf) {
          pdfDoc = pdf;
          totalPages = pdf.numPages;
          currentPage = 1;
          
          // 更新页面信息
          totalPagesEl.textContent = totalPages;
          updatePageInfo();
          
          // 渲染第一页
          renderPage(currentPage);
          
          // 显示PDF预览区域
          pdfPreviewSection.classList.remove('hidden');
          paginationControls.classList.remove('hidden');
          
          // 隐藏加载状态
          hideLoading();
          
          // 更新分页按钮状态
          updatePaginationButtons();
        }).catch(function(error) {
          console.error('加载PDF失败:', error);
          hideLoading();
          alert('加载PDF失败: ' + error.message);
        });
      };
      
      fileReader.readAsArrayBuffer(file);
    }

    // 渲染指定页
    function renderPage(num) {
      showLoading(`正在加载第 ${num} 页...`);
      
      pdfDoc.getPage(num).then(function(page) {
        // 根据选择的分辨率设置缩放比例
        const scale = parseFloat(renderDpiSelect.value);
        const viewport = page.getViewport({ scale: scale });
        
        // 准备画布
        pdfContainer.innerHTML = '';
        const canvas = document.createElement('canvas');
        const context = canvas.getContext('2d');
        canvas.height = viewport.height;
        canvas.width = viewport.width;
        canvas.className = 'pdf-preview mx-auto rounded-lg max-w-full';
        
        pdfContainer.appendChild(canvas);
        
        // 渲染页面内容 - 使用高质量渲染选项
        const renderContext = {
          canvasContext: context,
          viewport: viewport,
          enableWebGL: false,  // 禁用WebGL以获得更精确的渲染
          useOnlyCssZoom: false
        };
        
        const renderTask = page.render(renderContext);
        
        renderTask.promise.then(function() {
          hideLoading();
        }).catch(function(error) {
          console.error('渲染页面失败:', error);
          hideLoading();
          alert('渲染页面失败: ' + error.message);
        });
      });
    }

    // 更新分页信息
    function updatePageInfo() {
      pageInfoEl.textContent = `第 ${currentPage} 页 / 共 ${totalPages} 页`;
    }

    // 更新分页按钮状态
    function updatePaginationButtons() {
      prevPageBtn.disabled = currentPage <= 1;
      nextPageBtn.disabled = currentPage >= totalPages;
    }

    // 上一页
    prevPageBtn.addEventListener('click', function() {
      if (currentPage <= 1) return;
      currentPage--;
      renderPage(currentPage);
      updatePageInfo();
      updatePaginationButtons();
    });

    // 下一页
    nextPageBtn.addEventListener('click', function() {
      if (currentPage >= totalPages) return;
      currentPage++;
      renderPage(currentPage);
      updatePageInfo();
      updatePaginationButtons();
    });

    // 监听分辨率变化，重新渲染当前页
    renderDpiSelect.addEventListener('change', function() {
      if (pdfDoc) {
        renderPage(currentPage);
      }
    });

    // 转换所有页为图片（高质量模式）
    convertAllBtn.addEventListener('click', function() {
      if (!pdfDoc) return;
      
      convertedImages = [];
      imagesContainer.innerHTML = '';
      
      // 显示加载状态
      showLoading('正在转换页面 1/' + totalPages);
      
      // 逐页转换
      convertPage(1);
    });

    // 转换指定页为高质量图片
    function convertPage(pageNum) {
      if (pageNum > totalPages) {
        // 所有页转换完成
        hideLoading();
        displayConvertedImages();
        successSection.classList.remove('hidden');
        return;
      }
      
      // 更新加载状态
      showLoading(`正在转换页面 ${pageNum}/${totalPages}`);
      
      pdfDoc.getPage(pageNum).then(function(page) {
        // 设置高质量转换参数
        const scale = parseFloat(renderDpiSelect.value); // 根据选择的分辨率设置
        const viewport = page.getViewport({ scale: scale });
        
        // 创建高分辨率画布
        const canvas = document.createElement('canvas');
        const context = canvas.getContext('2d');
        canvas.height = viewport.height;
        canvas.width = viewport.width;
        
        // 高质量渲染配置
        const renderContext = {
          canvasContext: context,
          viewport: viewport,
          // 禁用抗锯齿以保留文字锐利度
          imageSmoothingEnabled: false,
          enableWebGL: false,
          useOnlyCssZoom: false
        };
        
        const renderTask = page.render(renderContext);
        
        renderTask.promise.then(function() {
          // 使用高画质参数转换为JPG
          const quality = parseFloat(imageQualitySelect.value);
          const imageDataUrl = canvas.toDataURL('image/jpeg', quality);
          
          // 保存图片信息
          convertedImages.push({
            pageNum: pageNum,
            dataUrl: imageDataUrl,
            width: canvas.width,
            height: canvas.height
          });
          
          // 转换下一页
          convertPage(pageNum + 1);
        }).catch(function(error) {
          console.error(`转换第 ${pageNum} 页失败:`, error);
          hideLoading();
          alert(`转换第 ${pageNum} 页失败: ${error.message}`);
        });
      });
    }

    // 显示转换后的高质量图片
    function displayConvertedImages() {
      imagesContainer.innerHTML = '';
      convertedCountEl.textContent = convertedImages.length;
      
      convertedImages.forEach(image => {
        const imageCard = document.createElement('div');
        imageCard.className = 'bg-white rounded-xl shadow-sm overflow-hidden hover:shadow-md transition-all duration-300 relative group border border-gray-100 animate-fadeIn';
        
        // 页码标识
        const pageBadge = document.createElement('div');
        pageBadge.className = 'absolute top-2 left-2 bg-primary text-white font-bold rounded-full w-8 h-8 flex items-center justify-center z-10 shadow-md';
        pageBadge.textContent = image.pageNum;
        imageCard.appendChild(pageBadge);
        
        // 分辨率信息
        const resolutionInfo = document.createElement('div');
        resolutionInfo.className = 'absolute bottom-2 left-2 bg-black/60 text-white text-xs px-2 py-1 rounded z-10';
        resolutionInfo.textContent = `${image.width}×${image.height}`;
        imageCard.appendChild(resolutionInfo);
        
        // 下载按钮
        const downloadBtn = document.createElement('button');
        downloadBtn.className = 'absolute top-2 right-2 bg-secondary/80 text-white rounded-full w-6 h-6 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-all duration-300 z-10 hover:bg-secondary';
        downloadBtn.innerHTML = '<i class="fa fa-download text-xs"></i>';
        downloadBtn.addEventListener('click', () => {
          downloadImage(image.dataUrl, `page-${image.pageNum}.jpg`);
        });
        imageCard.appendChild(downloadBtn);
        
        // 图片
        const img = document.createElement('img');
        img.src = image.dataUrl;
        img.className = 'w-full h-48 object-cover';
        img.alt = `PDF第 ${image.pageNum} 页`;
        imageCard.appendChild(img);
        
        // 图片信息
        const infoContainer = document.createElement('div');
        infoContainer.className = 'p-3';
        
        const pageInfo = document.createElement('div');
        pageInfo.className = 'text-sm font-medium text-gray-700';
        pageInfo.textContent = `第 ${image.pageNum} 页`;
        infoContainer.appendChild(pageInfo);
        
        const fileName = document.createElement('div');
        fileName.className = 'text-xs text-gray-500 mt-1';
        fileName.textContent = `page-${image.pageNum}.jpg (${image.width}×${image.height})`;
        infoContainer.appendChild(fileName);
        
        imageCard.appendChild(infoContainer);
        
        imagesContainer.appendChild(imageCard);
      });
      
      // 显示图片区域
      imagesSection.classList.remove('hidden');
    }

    // 下载单张高质量图片
    function downloadImage(dataUrl, fileName) {
      const link = document.createElement('a');
      link.download = fileName;
      link.href = dataUrl;
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
    }

    // 下载所有图片（打包成ZIP）
    downloadAllBtn.addEventListener('click', function() {
      if (convertedImages.length === 0) return;
      
      showLoading('正在打包高质量图片，可能需要较长时间...');
      
      const zip = new JSZip();
      const imgFolder = zip.folder("high-quality-pdf-images");
      
      // 计数器，确保所有图片都添加到ZIP后再下载
      let addedCount = 0;
      
      convertedImages.forEach(image => {
        // 从dataURL提取二进制数据
        const base64Data = image.dataUrl.split(',')[1];
        imgFolder.file(`page-${image.pageNum}.jpg`, base64Data, { base64: true });
        
        addedCount++;
        
        // 所有图片都已添加
        if (addedCount === convertedImages.length) {
          // 生成ZIP文件并下载
          zip.generateAsync({ 
            type: "blob",
            compression: "STORE"  // 不压缩以保持原始质量
          }).then(function(content) {
            saveAs(content, "high-quality-pdf-images.zip");
            hideLoading();
          }).catch(function(error) {
            console.error('打包图片失败:', error);
            hideLoading();
            alert('打包图片失败: ' + error.message);
          });
        }
      });
    });

    // 显示加载状态
    function showLoading(text) {
      loadingText.textContent = text || '正在处理，请稍候...';
      loadingSection.classList.remove('hidden');
      convertAllBtn.disabled = true;
      convertAllBtn.classList.add('opacity-70', 'cursor-not-allowed');
      downloadAllBtn.disabled = true;
      downloadAllBtn.classList.add('opacity-70', 'cursor-not-allowed');
    }

    // 隐藏加载状态
    function hideLoading() {
      loadingSection.classList.add('hidden');
      convertAllBtn.disabled = false;
      convertAllBtn.classList.remove('opacity-70', 'cursor-not-allowed');
      downloadAllBtn.disabled = false;
      downloadAllBtn.classList.remove('opacity-70', 'cursor-not-allowed');
    }

    // 页面滚动时改变导航栏样式
    window.addEventListener('scroll', () => {
      const header = document.querySelector('header');
      if (window.scrollY > 10) {
        header.classList.add('py-2', 'shadow-lg');
        header.classList.remove('py-4', 'shadow-md');
      } else {
        header.classList.add('py-4', 'shadow-md');
        header.classList.remove('py-2', 'shadow-lg');
      }
    });

    // 添加淡入动画
    document.head.insertAdjacentHTML('beforeend', `
      <style>
        @keyframes fadeIn {
          from { opacity: 0; transform: translateY(10px); }
          to { opacity: 1; transform: translateY(0); }
        }
        .animate-fadeIn {
          animation: fadeIn 0.3s ease-out forwards;
        }
      </style>
    `);
  </script>
</body>
</html>
